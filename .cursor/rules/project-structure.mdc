---
alwaysApply: true
description: 小红书内容批量处理项目结构指南
---

# 项目结构指南

这是一个小红书内容批量处理程序，用于自动化处理图片和文档内容。

## 核心文件说明

- [batch_processor.py](mdc:batch_processor.py) - 主批量处理程序，包含完整的处理流程
- [配置与提示词/ai_services.py](mdc:配置与提示词/ai_services.py) - AI服务集成模块，支持多模型降级
- [配置与提示词/改图片.py](mdc:配置与提示词/改图片.py) - 图片处理模块，包含滤镜、裁剪、边框功能
- [配置与提示词/openrouter.py](mdc:配置与提示词/openrouter.py) - OpenRouter API集成示例代码
- [README.md](mdc:README.md) - 项目文档和使用说明
- [配置与提示词/小红书改写.txt](mdc:配置与提示词/小红书改写.txt) - 小红书内容改写提示词模板
- [配置与提示词/小红书咪蒙标题生成.txt](mdc:配置与提示词/小红书咪蒙标题生成.txt) - 标题生成提示词模板

## 数据结构要求

```
根目录/
├── 子文件夹1/
│   ├── 图片文件 (.jpg, .jpeg, .png, .bmp)
│   ├── 正文文档 (.txt, .docx, .md)
│   └── filtered_images/ (自动生成)
├── 子文件夹2/
└── 输出文件夹/ (使用生成的标题命名)
    ├── 处理后的图片
    └── 改写后的正文.md
```

## 处理流程

1. **扫描输入**: 自动发现所有子文件夹
2. **图片处理**: 应用natural滤镜 → 裁剪底部19/20 → 添加白色边框
3. **内容改写**: 使用AI改写成小红书风格
4. **标题生成**: 基于改写内容生成吸引人的标题
5. **输出保存**: 创建新文件夹并保存结果

## 环境配置

- 需要 `配置与提示词/.env` 文件配置API密钥：
  - `OPENROUTER_API_KEY` - OpenRouter API密钥
  - `SILICONFLOW_API_KEY` - SiliconFlow API密钥（DeepSeek备用）
  - `MOONSHOT_API_KEY` - Moonshot API密钥（Kimi标题生成）
- Python 3.7+ 环境
- 依赖: OpenCV, NumPy, Requests, python-dotenv, openai

## AI服务架构

### 多模型降级机制
1. **内容改写**：
   - 主要：OpenRouter + DeepSeek-R1-0528
   - 备用：SiliconFlow + DeepSeek-V3.1
2. **标题生成**：
   - 专用：Moonshot + Kimi-K2-0711-Preview

### 服务模块
- [配置与提示词/ai_services.py](mdc:配置与提示词/ai_services.py) 提供统一的AI服务接口
- 自动降级和错误处理
- 支持重试机制和限流控制